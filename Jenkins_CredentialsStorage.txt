Secure Storage of Keystore, Certificates, Tokens & Truststore in Jenkins
ğŸ§­ First: What goes where? (Big Picture)
Secret Type	Store In Jenkins As	Why
API Tokens / JWT	Secret Text	Simple string
Username / Password	Username + Password	Native support
Keystore (.jks, .p12)	Secret File	Binary + password
Truststore (.jks)	Secret File	Binary
OAuth Client Secret	Secret Text	Rotation-friendly
Certificates (.pem, .crt)	Secret File	Binary

âœ” Never commit these into Git
âœ” Never hardcode in code or pom.xml

1ï¸âƒ£ Jenkins Credentials Types (What to Use)
ğŸ”¹ Navigate
Jenkins â†’ Manage Jenkins â†’ Credentials â†’ (Global / Folder)

ğŸ” A. Secret Text (Tokens, JWTs, API Keys)

Use for:

OAuth tokens

JWT

API keys

Create

Kind: Secret text

ID: API_TOKEN

Value: eyJhbGciOiJIUzI1NiIsInR5cCI6...

ğŸ” B. Username & Password

Use for:

Basic auth

Legacy APIs

Create

Kind: Username with password

ID: BASIC_AUTH

ğŸ” C. Secret File (Keystore / Truststore / Certs)

Use for:

.jks

.p12

.pem

Create

Kind: Secret file

ID: CLIENT_KEYSTORE

Upload: client.p12

Same for:

TRUSTSTORE_JKS

2ï¸âƒ£ Fetching Secrets in Jenkinsfile (Most Important)
ğŸ”¹ A. Fetch API Token (Secret Text)
withCredentials([string(credentialsId: 'API_TOKEN', variable: 'TOKEN')]) {
    sh '''
        mvn test -Dapi.token=$TOKEN
    '''
}

ğŸ‘‰ Use in Rest Assured
String token = System.getProperty("api.token");

given()
    .auth()
    .oauth2(token)
.when()
    .get("/users");

ğŸ”¹ B. Fetch Username & Password
withCredentials([usernamePassword(
    credentialsId: 'BASIC_AUTH',
    usernameVariable: 'USER',
    passwordVariable: 'PASS'
)]) {
    sh '''
        mvn test -Duser=$USER -Dpass=$PASS
    '''
}

ğŸ”¹ C. Fetch Keystore / Truststore (Secret File)
âœ… Best practice: Jenkins copies file to workspace temp path
withCredentials([file(credentialsId: 'CLIENT_KEYSTORE', variable: 'KEYSTORE_FILE')]) {
    sh '''
        mvn test -Dkeystore.path=$KEYSTORE_FILE
    '''
}

ğŸ‘‰ Rest Assured usage
String keystorePath = System.getProperty("keystore.path");
String keystorePassword = System.getenv("KEYSTORE_PASS");

given()
    .auth()
    .certificate(keystorePath, keystorePassword)
.when()
    .get("/secure-api");

ğŸ”¹ D. Truststore Fetching
withCredentials([file(credentialsId: 'TRUSTSTORE_JKS', variable: 'TRUSTSTORE_FILE')]) {
    sh '''
        mvn test -Dtruststore.path=$TRUSTSTORE_FILE
    '''
}

ğŸ‘‰ JVM SSL properties (recommended)
-Djavax.net.ssl.trustStore=${TRUSTSTORE_FILE}
-Djavax.net.ssl.trustStorePassword=changeit

3ï¸âƒ£ Recommended Jenkins Secret Layout (Enterprise)
Credentials
â”œâ”€â”€ API_TOKEN (Secret Text)
â”œâ”€â”€ OAUTH_CLIENT_SECRET (Secret Text)
â”œâ”€â”€ BASIC_AUTH (Username/Password)
â”œâ”€â”€ CLIENT_KEYSTORE (Secret File)
â”œâ”€â”€ TRUSTSTORE_JKS (Secret File)
â”œâ”€â”€ KEYSTORE_PASS (Secret Text)
â”œâ”€â”€ TRUSTSTORE_PASS (Secret Text)

4ï¸âƒ£ CI/CD-Safe Jenkinsfile Example (Complete)
pipeline {
    agent any

    stages {
        stage('Run Secure API Tests') {
            steps {
                withCredentials([
                    string(credentialsId: 'API_TOKEN', variable: 'TOKEN'),
                    file(credentialsId: 'CLIENT_KEYSTORE', variable: 'KEYSTORE'),
                    string(credentialsId: 'KEYSTORE_PASS', variable: 'KPASS')
                ]) {
                    sh '''
                        mvn test \
                        -Dapi.token=$TOKEN \
                        -Dkeystore.path=$KEYSTORE \
                        -Dkeystore.password=$KPASS
                    '''
                }
            }
        }
    }
}

5ï¸âƒ£ Why NOT Store in pom.xml or Git?

âŒ pom.xml â†’ visible in logs
âŒ Git â†’ security breach
âŒ Jenkins env vars globally â†’ leaked to other jobs

âœ” Jenkins Credentials â†’ masked in logs
âœ” Scoped per job/folder
âœ” Rotatable without code change

6ï¸âƒ£ Handling Certificates in Docker / Kubernetes Jenkins
ğŸ”¹ Mount certs at runtime
volumeMounts:
- name: keystore
  mountPath: /certs

-Dkeystore.path=/certs/client.p12

7ï¸âƒ£ Common CI Failures & Fixes
Error	Root Cause	Fix
PKIX path building failed	Missing truststore	Add truststore
File not found	Wrong credentialsId	Check Jenkins ID
SSLHandshakeException	Cert mismatch	Correct keystore
Token expired	Static token	Dynamic token job
ğŸ§  Interview-Ready Summary

Keystores, truststores, certificates, and tokens should be stored securely in Jenkins Credentials â€” using Secret Text for tokens and Secret File for binary artifacts. They are injected at runtime using withCredentials, passed as JVM or Maven properties, and never committed to source control.