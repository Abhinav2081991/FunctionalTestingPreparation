How to Test API Gateways Using Rest Assured (Java)
1ï¸âƒ£ What You Are Actually Testing in an API Gateway

You are NOT testing business logic â€” you are testing cross-cutting concerns.

Key Responsibilities to Validate

	Authentication & Authorization
	Routing
	Rate Limiting & Throttling
	Request / Response Transformation
	Header Propagation
	Aggregation
	Error Handling
	Resilience (timeouts, fallbacks)
	Versioning
	Security (CORS, IP blocking)

2ï¸âƒ£ Test Setup (Base Class)

public class BaseGatewayTest {

				@BeforeClass
				public void setup() {
					RestAssured.baseURI = "https://api.mycompany.com";
				}
			}

3ï¸âƒ£ Authentication & Authorization Testing ğŸ”
			âœ… Valid Token
			given()
			  .header("Authorization", "Bearer validToken")
			.when()
			  .get("/api/orders")
			.then()
			  .statusCode(200);

			âŒ Missing Token
			given()
			.when()
			  .get("/api/orders")
			.then()
			  .statusCode(401);

			âŒ Invalid Scope / Role
			given()
			  .header("Authorization", "Bearer userToken")
			.when()
			  .delete("/api/orders/123")
			.then()
			  .statusCode(403);


		âœ”ï¸ Gateway responsibility â†’ Access control
		âœ”ï¸ Backend should never receive invalid requests

4ï¸âƒ£ Routing Validation ğŸš¦
			Ensure Correct Service is Hit
			given()
			  .header("Authorization", "Bearer token")
			.when()
			  .get("/api/users/10")
			.then()
			  .statusCode(200)
			  .body("service", equalTo("USER-SERVICE"));


		Backend may return a service identifier header or response field.

5ï¸âƒ£ Rate Limiting / Throttling ğŸš¥

			Example: 5 Requests Per Minute
			for (int i = 1; i <= 6; i++) {
				given()
				  .header("Authorization", "Bearer token")
				.when()
				  .get("/api/products")
				.then()
				  .statusCode(i <= 5 ? 200 : 429);
			}

			Validate Rate Limit Headers
			.then()
			  .header("X-RateLimit-Remaining", notNullValue());

6ï¸âƒ£ Header Propagation Testing ğŸ“¤
			Gateway Adds Headers
			
			given()
			  .header("Authorization", "Bearer token")
			.when()
			  .get("/api/orders")
			.then()
			  .header("X-Correlation-ID", notNullValue());

Custom Headers Forwarded
			given()
			  .header("X-Client-Id", "mobile-app")
			.when()
			  .get("/api/orders")
			.then()
			  .statusCode(200);

7ï¸âƒ£ Request Transformation Testing ğŸ”„

Client Sends One Format â†’ Backend Receives Another
			given()
			  .contentType(ContentType.JSON)
			  .body("{ \"userId\": 10 }")
			.when()
			  .post("/api/createUser")
			.then()
			  .statusCode(201);


âœ”ï¸ Validate transformed response structure
âœ”ï¸ Validate required fields exist

8ï¸âƒ£ Response Transformation Testing
			.then()
			  .body("data.userId", notNullValue())
			  .body("meta.timestamp", notNullValue());


Gateway often wraps backend response into a standard envelope.

9ï¸âƒ£ API Aggregation Testing ğŸ§©
		Single API â†’ Multiple Services
		given()
		  .header("Authorization", "Bearer token")
		.when()
		  .get("/api/dashboard")
		.then()
		  .statusCode(200)
		  .body("orders", notNullValue())
		  .body("payments", notNullValue())
		  .body("products", notNullValue());

Partial Failure Handling
		.then()
		  .body("payments", nullValue())
		  .body("errors[0].service", equalTo("PAYMENT-SERVICE"));

ğŸ”Ÿ Timeout & Circuit Breaker Testing â±ï¸
Simulate Backend Timeout
		given()
		.when()
		  .get("/api/slow-service")
		.then()
		  .statusCode(504);

Fallback Response
		.then()
		  .body("message", equalTo("Service temporarily unavailable"));

1ï¸âƒ£1ï¸âƒ£ Error Mapping Validation ğŸ›‘
Backend Error	Gateway Response
500	502 / 503
404	404
		Timeout	504
		.then()
		  .statusCode(503)
		  .body("errorCode", equalTo("SERVICE_UNAVAILABLE"));

1ï¸âƒ£2ï¸âƒ£ API Versioning Testing ğŸ§¬
		Path Versioning
		.get("/v1/api/orders")
		.get("/v2/api/orders")

		Header Versioning
		given()
		  .header("API-Version", "2")
		.when()
		  .get("/api/orders")
		.then()
		  .statusCode(200);

1ï¸âƒ£3ï¸âƒ£ CORS Testing ğŸŒ
given()
  .header("Origin", "https://evil.com")
.when()
  .options("/api/orders")
.then()
  .statusCode(403);

1ï¸âƒ£4ï¸âƒ£ Contract Validation (Schema)
.then()
  .body(matchesJsonSchemaInClasspath("gateway-response-schema.json"));

1ï¸âƒ£5ï¸âƒ£ Logging & Traceability Validation
Response response =
given()
  .header("Authorization", "Bearer token")
.when()
  .get("/api/orders");

String traceId = response.getHeader("X-Trace-Id");
assertNotNull(traceId);

1ï¸âƒ£6ï¸âƒ£ Negative Testing (Must Ask in Interview)

Invalid headers
Missing mandatory params
Oversized payload
SQL / XSS attempts
Unsupported HTTP methods

.when()
  .patch("/api/orders")
.then()
  .statusCode(405);

1ï¸âƒ£7ï¸âƒ£ How to Explain This in Interview (Perfect Answer)

API Gateway testing focuses on validating cross-cutting concerns like authentication, routing, rate limiting, request/response transformation, aggregation, and error handling. Using Rest Assured, I test both positive and negative scenarios, validate headers, throttling behavior, fallback responses, and ensure backend services are protected from invalid requests.

1ï¸âƒ£8ï¸âƒ£ What Interviewers LOVE to Hear â¤ï¸

âœ” â€œGateway should block before backendâ€
âœ” â€œFocus on headers and status codesâ€
âœ” â€œRate limiting and securityâ€
âœ” â€œAggregation and fallback handlingâ€

1ï¸âƒ£9ï¸âƒ£ Common Mistake âŒ

Testing business logic at gateway level

âœ”ï¸ Business logic â†’ service tests
âœ”ï¸ Cross-cutting concerns â†’ gateway tests



------------------------------------------------------------------------------------------------------------------------------------------------------------


What Does â€œThresholdâ€ Mean in SonarQube?

A threshold defines:
When a rule should raise an issue
How severe that issue is
When it should fail the Quality Gate

Bad thresholds = noisy Sonar â†’ ignored by teams
Good thresholds = trusted Sonar â†’ enforced in CI

ğŸ§  Rule Threshold Strategy (Selenium Automation)
1ï¸âƒ£ Thread.sleep() Usage
ğŸ”´ Rule

AvoidThreadSleepInTests

ğŸ¯ Threshold
Metric				Value
Allowed				0 occurrences
Severity			Major
Quality Gate		âŒ Fail if â‰¥ 1
ğŸ’¡ Why?

Even one Thread.sleep() is harmful
No legitimate use in automation frameworks

ğŸ“Œ Hard stop rule

2ï¸âƒ£ Direct driver.findElement() Outside Pages
ğŸ”´ Rule

NoFindElementOutsidePageObject

ğŸ¯ Threshold  --
Metric					Value
Allowed					0 in steps, tests
Severity				Major
Gate					âŒ Fail if â‰¥ 1

ğŸ“Œ Exception:
Allowed inside pages.* only



3ï¸âƒ£ Static WebDriver Declaration
ğŸ”´ Rule

NoStaticWebDriver

ğŸ¯ Threshold
Metric					Value
Allowed					0
Severity				Critical
Gate					âŒ Immediate fail

ğŸ’¥ Parallel execution killer

4ï¸âƒ£ Assertions Inside Page Objects
ğŸ”´ Rule

NoAssertionsInPageObjects

ğŸ¯ Threshold
Metric				Value
Allowed				0
Severity			Major
Gate				âŒ Fail

ğŸ’¡ Pages must never assert â€” strict rule

5ï¸âƒ£ Page Object Size (SRP Violation)
ğŸ”´ Rule

SinglePageResponsibility

ğŸ¯ Threshold
Metric				Recommended
Max methods			10â€“12
Max fields			10
Severity			Major
Gate				âš  Warn only (initially)

ğŸ’¡ Why not fail?

Legacy pages may be large
Start as Code Smell, then enforce later

6ï¸âƒ£ Missing Wait Strategy Before Action
ğŸ”´ Rule

EnforceWaitStrategy

ğŸ¯ Threshold
Metric				Value
Allowed				0
Severity			Critical
Gate				âŒ Fail

ğŸ’¡ Any click/type without wait is dangerous

7ï¸âƒ£ Hard-Coded Test Data in Page Objects
ğŸ”´ Rule

NoHardcodedTestDataInPages

ğŸ¯ Threshold
Metric				Value
Allowed				â‰¤ 1 (temporary)
Severity			Minor â†’ Major
Gate				âš  Warn

ğŸ’¡ Useful during framework evolution

8ï¸âƒ£ Step Definitions Using WebDriver Directly
ğŸ”´ Rule

StepDefsShouldUsePagesOnly

ğŸ¯ Threshold
Metric			Value
Allowed			0
Severity		Major
Gate			âŒ Fail

ğŸ“Œ Step defs = orchestration only

9ï¸âƒ£ Fluent / Explicit Wait Max Timeout
ğŸ”´ Rule

MaxWaitTimeout

ğŸ¯ Threshold
Metric			Value
Max wait		20 seconds
Severity		Minor
Gate			âš  Warn

ğŸ’¡ Excessive waits hide performance issues

ğŸ“Š Summary Table (Interview Ready)
Rule							Threshold	Severity	Gate
Thread.sleep					0			Major		Fail
Static WebDriver				0			Critical	Fail
findElement outside POM			0			Major		Fail
Assertions in Pages				0			Major		Fail
Missing wait strategy			0			Critical	Fail
Page size (methods)				>12			Major		Warn
Hard-coded data					>1			Minor		Warn
Max wait time					>20s		Minor		Warn


ğŸ¯ Quality Gate Recommendation (Automation)

FAIL BUILD if:

Any Critical issue

â‰¥1 Major bug

Code coverage < 60% (automation code)

WARN only if:

Code smells

Maintainability issues